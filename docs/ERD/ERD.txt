## DATABASE SCHEMA - SOPS (SBS Point of Sale)

---

## 1. Kategori
1.1 id_kategori | VARCHAR(4) | PK
1.2 nama | VARCHAR(50) | UNIQUE NOT NULL

---

## 2. Produk
2.1 id_produk | BIGINT | PK AUTO_INCREMENT
2.2 sku | VARCHAR(20) | UNIQUE NOT NULL
2.3 barcode | VARCHAR(50)
2.4 no_bpom | VARCHAR(50)
2.5 nama | VARCHAR(100) | NOT NULL
2.6 id_kategori | VARCHAR(4) | FK, NOT NULL
2.7 satuan | VARCHAR(20) | NOT NULL
2.8 isi_per_pack | INT | DEFAULT 1
2.9 stok | INT | NOT NULL
2.10 sisa_pcs_terbuka | INT | DEFAULT 0
2.11 harga | BIGINT | NOT NULL
2.12 harga_pack | BIGINT
2.13 batas_stok_minimum | INT | DEFAULT 0
2.14 jumlah_restock | INT | DEFAULT 0

---

## 3. Konversi Stok
3.1 id_konversi | BIGINT | PK AUTO_INCREMENT
3.2 from_produk_id | BIGINT | FK NOT NULL
3.3 to_produk_id | BIGINT | FK NOT NULL
3.4 rasio | DECIMAL(5,2) | NOT NULL
3.5 qty_from | INT | NOT NULL
3.6 qty_to | INT | NOT NULL
3.7 mode | ENUM('partial','full') | NOT NULL
3.8 packs_used | INT | DEFAULT 0
3.9 stok_awal_pcs | INT | DEFAULT 0
3.10 stok_sisa_pcs | INT | DEFAULT 0
3.11 keterangan | TEXT

---

## 4. Pemesanan Barang
4.1 id_pemesanan_barang | BIGINT | PK AUTO_INCREMENT
4.2 nomor_po | VARCHAR(30) | UNIQUE NOT NULL
4.3 status | ENUM('draft','submitted','approved','rejected','received','partial_received') | DEFAULT 'draft'
4.4 tanggal_request | TIMESTAMP | NOT NULL
4.5 tanggal_approval | TIMESTAMP
4.6 catatan_approval | TEXT
4.7 id_kasir | VARCHAR(8) | FK NOT NULL
4.8 id_admin | VARCHAR(8) | FK

---

## 5. Detail Pemesanan Barang
5.1 id_detail_pemesanan_barang | BIGINT | PK AUTO_INCREMENT
5.2 id_pemesanan_barang | BIGINT | FK NOT NULL
5.3 id_produk | BIGINT | FK NOT NULL
5.4 jumlah_dipesan | INT | NOT NULL
5.5 jumlah_diterima | INT | DEFAULT 0

---

## 6. Penerimaan Barang
6.1 id_penerimaan_barang | BIGINT | PK AUTO_INCREMENT
6.2 id_pemesanan_barang | BIGINT | FK NOT NULL
6.3 id_detail_pemesanan_barang | BIGINT | FK NOT NULL
6.4 id_produk | BIGINT | FK NOT NULL
6.5 jumlah_diterima | INT | NOT NULL
6.6 jumlah_rusak | INT | DEFAULT 0
6.7 id_kasir | VARCHAR(8) | FK
6.8 catatan | TEXT
6.9 status | ENUM('pending','completed') | DEFAULT 'completed'

---

## 7. Penyesuaian Stok
7.1 id_penyesuaian | BIGINT | PK AUTO_INCREMENT
7.2 id_produk | BIGINT | FK NOT NULL
7.3 tipe | ENUM('retur_pelanggan','retur_gudang','koreksi_plus','expired','rusak','koreksi_minus','lainnya') | NOT NULL
7.4 jumlah_penyesuaian | INT | NOT NULL
7.5 alasan | TEXT
7.6 id_pengguna | VARCHAR(8) | FK NOT NULL
7.7 tanggal_adjustment | TIMESTAMP | NOT NULL

---

## 8. Pengguna
8.1 id_pengguna | VARCHAR(8) | PK
8.2 nama | VARCHAR(100) | NOT NULL
8.3 email | VARCHAR(100) | UNIQUE NOT NULL
8.4 telepon | VARCHAR(20)
8.5 password | VARCHAR(255) | NOT NULL
8.6 role | ENUM('admin','kasir') | NOT NULL
8.7 terakhir_login | TIMESTAMP
8.8 remember_token | VARCHAR(100)

---

## 9. Pelanggan
9.1 id_pelanggan | BIGINT | PK AUTO_INCREMENT
9.2 nama | VARCHAR(100) | NOT NULL
9.3 email | VARCHAR(100)
9.4 telepon | VARCHAR(20) | UNIQUE NOT NULL
9.5 kota | VARCHAR(50)
9.6 alamat | TEXT
9.7 aktif | TINYINT(1) | DEFAULT 1
9.8 trust_score | INT | DEFAULT 50
9.9 credit_limit | BIGINT | DEFAULT 0
9.10 status_kredit | ENUM('inactive','active','suspended') | DEFAULT 'inactive'
9.11 saldo_kredit | BIGINT | DEFAULT 0

---

## 10. Transaksi
10.1 nomor_transaksi | VARCHAR(20) | PK
10.2 id_pelanggan | BIGINT | FK NOT NULL
10.3 id_kasir | VARCHAR(8) | FK NOT NULL
10.4 tanggal | TIMESTAMP | NOT NULL
10.5 total_item | INT | NOT NULL
10.6 subtotal | BIGINT | NOT NULL
10.7 diskon | BIGINT | DEFAULT 0
10.8 pajak | BIGINT | DEFAULT 0
10.9 biaya_pengiriman | BIGINT | DEFAULT 0
10.10 total | BIGINT | NOT NULL
10.11 metode_bayar | VARCHAR(50) | NOT NULL
10.12 status_pembayaran | ENUM('pending','paid','partially_paid') | DEFAULT 'pending'
10.13 paid_at | TIMESTAMP
10.14 jenis_transaksi | ENUM('tunai','kredit') | NOT NULL
10.15 dp | BIGINT | DEFAULT 0
10.16 tenor_bulan | INT
10.17 bunga_persen | DECIMAL(5,2)
10.18 cicilan_bulanan | BIGINT
10.19 ar_status | ENUM('draft','verified','done') | DEFAULT 'draft'
10.20 id_kontrak | BIGINT | FK

---

## 11. Transaksi Detail
11.1 id_detail | BIGINT | PK AUTO_INCREMENT
11.2 nomor_transaksi | VARCHAR(20) | FK NOT NULL
11.3 id_produk | BIGINT | FK NOT NULL
11.4 nama_produk | VARCHAR(100) | NOT NULL
11.5 harga_satuan | BIGINT | NOT NULL
11.6 jumlah | INT | NOT NULL
11.7 jenis_satuan | VARCHAR(20) | NOT NULL
11.8 isi_pack_saat_transaksi | INT
11.9 diskon_item | BIGINT | DEFAULT 0
11.10 subtotal | BIGINT | NOT NULL

---

## 12. Kontrak Kredit
12.1 id_kontrak | BIGINT | PK AUTO_INCREMENT
12.2 nomor_kontrak | VARCHAR(30) | UNIQUE NOT NULL
12.3 id_pelanggan | BIGINT | FK NOT NULL
12.4 nomor_transaksi | VARCHAR(20) | FK
12.5 mulai_kontrak | DATE | NOT NULL
12.6 tenor_bulan | INT | NOT NULL
12.7 pokok_pinjaman | BIGINT | NOT NULL
12.8 dp | BIGINT | NOT NULL
12.9 bunga_persen | DECIMAL(5,2) | NOT NULL
12.10 cicilan_bulanan | BIGINT | NOT NULL
12.11 status | ENUM('active','settled','default') | NOT NULL
12.12 score_snapshot | INT

---

## 13. Jadwal Angsuran
13.1 id_angsuran | BIGINT | PK AUTO_INCREMENT
13.2 id_kontrak | BIGINT | FK NOT NULL
13.3 periode_ke | INT | NOT NULL
13.4 jatuh_tempo | DATE | NOT NULL
13.5 jumlah_tagihan | BIGINT | NOT NULL
13.6 jumlah_dibayar | BIGINT | DEFAULT 0
13.7 status | ENUM('due','late','paid') | DEFAULT 'due'
13.8 paid_at | TIMESTAMP

---

## 14. Pembayaran
14.1 id_pembayaran | BIGINT | PK AUTO_INCREMENT
14.2 id_transaksi | VARCHAR(20) | FK
14.3 id_angsuran | BIGINT | FK
14.4 metode | VARCHAR(50) | NOT NULL
14.5 jumlah | BIGINT | NOT NULL
14.6 tanggal | TIMESTAMP | NOT NULL
14.7 keterangan | TEXT
14.8 id_pelanggan | BIGINT | FK NOT NULL
14.9 id_kasir | VARCHAR(8) | FK NOT NULL
14.10 tipe_pembayaran | ENUM('tunai','transfer','kredit') | NOT NULL
